import requests
import sys

SERVER_URL = "http://127.0.0.1:8000/query"
DEFAULT_PROMPT = "This software has a"

def query_model(prompt):
    """向服务器发送查询并打印结果"""
    print(f"\n[用户视角] 正在向服务器发送请求...")
    print(f"[用户视角] 输入内容: '{prompt}'")
    
    try:
        response = requests.post(SERVER_URL, json={"prompt": prompt})
        response.raise_for_status()
        data = response.json()
        
        print("\n[用户视角] 收到来自服务器的响应:")
        print("-" * 30)
        print(data.get("response", "无效的响应格式"))
        print("-" * 30)

    except requests.exceptions.RequestException as e:
        print("\n[用户视角] 错误：无法连接到AI服务器。请确保服务器正在运行。")
        print(f"错误详情: {e}")

if __name__ == "__main__":
    # 如果用户从命令行提供了输入，就使用它，否则使用默认的prompt
    prompt_to_send = sys.argv[1] if len(sys.argv) > 1 else DEFAULT_PROMPT
    query_model(prompt_to_send)